<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cube Solver - SpeedSolverX</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="nav-title-link">
                <h1 class="nav-title">SpeedSolverX</h1>
            </a>
            <div class="nav-user">
                <span>Welcome, {{ current_user.id }}!</span>
                <a href="/timer" class="nav-link"><i class="fas fa-stopwatch"></i> Timer</a>
                <a href="/stats" class="nav-link"><i class="fas fa-chart-line"></i> Stats</a>
                <a href="/settings" class="nav-link"><i class="fas fa-cog"></i> Settings</a>
                <a href="/logout" class="nav-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Solver Header -->
        <div class="solver-header">
            <h2><i class="fas fa-magic"></i> Cube Solver</h2>
            <p>Solve any scrambled 3x3 cube with our advanced algorithm</p>
        </div>

        <!-- Input Method Selection -->
        <div class="input-method-section">
            <h3>Choose Input Method</h3>
            <div class="method-buttons">
                <button id="visualInputBtn" class="method-btn active">
                    <i class="fas fa-palette"></i>
                    Visual Input
                </button>
                <button id="cameraInputBtn" class="method-btn">
                    <i class="fas fa-camera"></i>
                    Camera Input
                </button>
            </div>
        </div>

        <!-- Visual Input Section -->
        <div id="visualInputSection" class="input-section active">
            <div class="visual-input-container">
                <!-- Color Palette -->
                <div class="color-palette">
                    <h4>Select Color</h4>
                    <div class="color-options">
                        <div class="color-option" data-color="white" style="background: #ffffff;" title="White"></div>
                        <div class="color-option" data-color="yellow" style="background: #ffff00;" title="Yellow"></div>
                        <div class="color-option active" data-color="blue" style="background: #0066cc;" title="Blue"></div>
                        <div class="color-option" data-color="green" style="background: #00cc00;" title="Green"></div>
                        <div class="color-option" data-color="red" style="background: #cc0000;" title="Red"></div>
                        <div class="color-option" data-color="orange" style="background: #ff6600;" title="Orange"></div>
                    </div>
                    <div class="selected-color-info">
                        <span>Selected: <span id="selectedColorName">Blue</span></span>
                    </div>
                </div>

                <!-- Cube Face Display -->
                <div class="cube-face-container">
                    <div class="face-header">
                        <h4 id="currentFaceName">Blue Face (Front)</h4>
                        <div class="face-navigation">
                            <button id="prevFaceBtn" class="nav-btn" disabled>
                                <i class="fas fa-chevron-left"></i> Previous
                            </button>
                            <span id="faceCounter">1 / 6</span>
                            <button id="nextFaceBtn" class="nav-btn">
                                Next <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>

                    <div class="cube-face" id="cubeFace">
                        <!-- 3x3 grid will be generated by JavaScript -->
                    </div>

                    <div class="face-instructions">
                        <p id="faceInstructions">Click on the squares to set their colors. The center is already set to blue.</p>
                    </div>
                </div>

                <!-- Progress and Controls -->
                <div class="visual-controls">
                    <div class="progress-indicator">
                        <div class="progress-steps">
                            <div class="step active" data-step="0">1</div>
                            <div class="step" data-step="1">2</div>
                            <div class="step" data-step="2">3</div>
                            <div class="step" data-step="3">4</div>
                            <div class="step" data-step="4">5</div>
                            <div class="step" data-step="5">6</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 16.67%"></div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button id="resetFaceBtn" class="btn btn-secondary">
                            <i class="fas fa-undo"></i> Reset Face
                        </button>
                        <button id="solveCubeBtn" class="btn btn-primary" style="display: none;">
                            <i class="fas fa-magic"></i> Solve Cube
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Camera Input Section -->
        <div id="cameraInputSection" class="input-section">
            <div class="camera-container">
                <div class="camera-header">
                    <h4>Camera Cube Detection</h4>
                    <p>Show each face of your cube to the camera in the specified order</p>
                </div>

                <div class="camera-view">
                    <video id="cameraVideo" autoplay muted></video>
                    <canvas id="cameraCanvas" style="display: none;"></canvas>
                    <div class="camera-overlay">
                        <div class="face-guide">
                            <div class="guide-square"></div>
                            <p id="cameraInstructions">Show the Blue face to the camera</p>
                        </div>
                    </div>
                </div>

                <div class="camera-controls">
                    <button id="startCameraBtn" class="btn btn-primary">
                        <i class="fas fa-video"></i> Start Camera
                    </button>
                    <button id="captureBtn" class="btn btn-success" style="display: none;">
                        <i class="fas fa-camera"></i> Capture Face
                    </button>
                    <button id="stopCameraBtn" class="btn btn-danger" style="display: none;">
                        <i class="fas fa-stop"></i> Stop Camera
                    </button>
                </div>

                <div class="captured-faces" id="capturedFaces">
                    <!-- Captured face previews will appear here -->
                </div>
            </div>
        </div>

        <!-- Solution Display -->
        <div id="solutionSection" class="solution-section" style="display: none;">
            <h3><i class="fas fa-lightbulb"></i> Solution</h3>
            <div class="solution-container">
                <div class="solution-display" id="solutionDisplay">
                    <!-- Solution will be displayed here -->
                </div>
                <div class="solution-controls">
                    <button id="copySolutionBtn" class="btn btn-secondary">
                        <i class="fas fa-copy"></i> Copy Solution
                    </button>
                    <button id="newSolveBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Solve Another
                    </button>
                </div>
            </div>
        </div>

        {% if solution %}
        <div class="solution-section">
            <h3><i class="fas fa-lightbulb"></i> Solution</h3>
            <div class="solution-container">
                <div class="solution-display">
                    {{ solution }}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <script src="/static/solver.js"></script>
</body>
</html>
